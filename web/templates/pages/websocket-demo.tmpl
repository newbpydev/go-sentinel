{{define "title"}}WebSocket Demo | Go Sentinel{{end}}
{{define "description"}}WebSocket demo for frontend JavaScript{{end}}

{{define "content"}}
<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-6">WebSocket Demo</h1>

    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-semibold mb-4">Connection Status</h2>
        <div class="flex items-center mb-4">
            <span class="mr-2">Status:</span>
            <span id="connection-status" class="px-2 py-1 rounded text-sm font-medium">Disconnected</span>
        </div>

        <div class="flex space-x-4 mb-6">
            <button id="connect-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                Connect
            </button>
            <button id="disconnect-btn" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                Disconnect
            </button>
            <button data-test-action="run-tests" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                Run Tests
            </button>
            <button data-test-action="get-metrics"
                class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">
                Get Metrics
            </button>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">Test Results</h2>
            <div id="test-results" class="min-h-32 border rounded p-4">
                <p class="text-gray-500">No test results available. Click "Run Tests" to start.</p>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">Metrics</h2>
            <pre id="metrics" class="bg-gray-100 p-4 rounded overflow-auto max-h-64">No metrics data available</pre>
        </div>
    </div>

    <div id="notifications" class="fixed bottom-4 right-4 space-y-2 w-80">
        <!-- Notifications will be inserted here by JavaScript -->
    </div>
</div>
{{end}}

{{define "scripts"}}
<script src="/static/js/websocket.js"></script>
<script src="/static/js/app.js"></script>

<script>
    // Additional WebSocket demo functionality
    document.addEventListener('DOMContentLoaded', () => {
        const connectBtn = document.getElementById('connect-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');

        if (connectBtn && window.wsClient) {
            connectBtn.addEventListener('click', () => {
                window.wsClient.connect();
            });
        }

        if (disconnectBtn && window.wsClient) {
            disconnectBtn.addEventListener('click', () => {
                window.wsClient.close();
            });
        }
    });
</script>

<style>
    /* Status styles */
    .status {
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
        font-weight: 500;
    }

    .status.connected {
        background-color: #dcfce7;
        color: #166534;
    }

    .status.disconnected {
        background-color: #fee2e2;
        color: #991b1b;
    }

    /* Table styles */
    .test-results-table {
        min-width: 100%;
        border-collapse: collapse;
    }

    .test-results-table th {
        padding: 0.75rem 1rem;
        background-color: #f9fafb;
        text-align: left;
        font-size: 0.75rem;
        font-weight: 500;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .test-results-table td {
        padding: 0.75rem 1rem;
        white-space: nowrap;
        font-size: 0.875rem;
        color: #111827;
    }

    /* Test result styles */
    .test-result.passed {
        background-color: #f0fdf4;
    }

    .test-result.failed {
        background-color: #fef2f2;
    }

    .test-result.skipped {
        background-color: #fffbeb;
    }

    /* Status badge styles */
    .status-badge {
        padding: 0.25rem 0.5rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        display: inline-block;
    }

    .status-badge.passed {
        background-color: #dcfce7;
        color: #166534;
    }

    .status-badge.failed {
        background-color: #fee2e2;
        color: #991b1b;
    }

    .status-badge.skipped {
        background-color: #fef3c7;
        color: #92400e;
    }

    /* Notification styles */
    .notification {
        padding: 1rem;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        color: white;
        font-weight: 500;
        animation: fadeIn 0.3s ease-in-out;
        margin-bottom: 0.5rem;
    }

    .notification.info {
        background-color: #3b82f6;
    }

    .notification.success {
        background-color: #10b981;
    }

    .notification.warning {
        background-color: #f59e0b;
    }

    .notification.error {
        background-color: #ef4444;
    }

    .notification.fade-out {
        animation: fadeOut 0.3s ease-in-out forwards;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }

        to {
            opacity: 0;
            transform: translateY(-10px);
        }
    }
</style>
{{end}}